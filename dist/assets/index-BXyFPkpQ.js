const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeView-DbZnWzIX.js","assets/storyModel-C3CKOtsZ.js","assets/idb-AsxtWpiW.js","assets/storyApi-CisDlYOj.js","assets/favoritesModel-BngbJ05d.js","assets/AuthView-D38J_V5n.js","assets/AddView-lcGVTiIS.js","assets/FavoritesView-DwQNNrNj.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const N="modulepreload",W=function(e){return"/noteapp-book/"+e},I={},u=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),s=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(r.map(c=>{if(c=W(c),c in I)return;I[c]=!0;const g=c.endsWith(".css"),T=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${T}`))return;const l=document.createElement("link");if(l.rel=g?"stylesheet":N,g||(l.as="script"),l.crossOrigin="",l.href=c,s&&l.setAttribute("nonce",s),document.head.appendChild(l),g)return new Promise((O,B)=>{l.addEventListener("load",O),l.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i}return n.then(i=>{for(const s of i||[])s.status==="rejected"&&o(s.reason);return t().catch(o)})},k={"/":()=>u(()=>import("./HomeView-DbZnWzIX.js"),__vite__mapDeps([0,1,2,3,4])).then(e=>e.default),"/auth":()=>u(()=>import("./AuthView-D38J_V5n.js"),__vite__mapDeps([5,3])).then(e=>e.default),"/add":()=>u(()=>import("./AddView-lcGVTiIS.js"),__vite__mapDeps([6,1,2,3])).then(e=>e.default),"/favorites":()=>u(()=>import("./FavoritesView-DwQNNrNj.js"),__vite__mapDeps([7,4,2])).then(e=>e.default),"*":()=>u(()=>import("./NotFoundView-K9wNmN2R.js"),[]).then(e=>e.default)};async function U(){const e=(location.hash||"#/").slice(1)||"/";return(k[e]||k["*"])()}function y(){const e=document.getElementById("main");e&&location.hash==="#main"&&requestAnimationFrame(()=>e.focus())}function E(){const e=document.getElementById("main");e&&e.focus()}async function b(){if("serviceWorker"in navigator)try{const{registerSW:e}=await u(async()=>{const{registerSW:t}=await import("./virtual_pwa-register-DcisdNUz.js");return{registerSW:t}},[]);e({immediate:!0})}catch{await navigator.serviceWorker.register("/noteapp-book/sw.js")}}const w="token",p="userName",_={getToken:()=>localStorage.getItem(w),setToken:e=>e?localStorage.setItem(w,e):localStorage.removeItem(w),clearToken:()=>localStorage.removeItem(w),getUserName:()=>localStorage.getItem(p)||"",setUserName:e=>e&&e.trim()?localStorage.setItem(p,e):localStorage.removeItem(p),clearUserName:()=>localStorage.removeItem(p)},C=e=>{const t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/-/g,"+").replace(/_/g,"/"),a=atob(r),n=new Uint8Array(a.length);for(let o=0;o<a.length;o++)n[o]=a.charCodeAt(o);return n},D="https://your-api.example.com",V="----VAPID_PUBLIC_KEY_DARI_API----";async function R(){if(!("Notification"in window))throw new Error("Browser tidak mendukung Notification");if(await Notification.requestPermission()!=="granted")throw new Error("Izin notifikasi ditolak");const r=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:C(V)});return await K(r),r}async function K(e){const t=_.getToken();if(!(await fetch(`${D}/subscribe`,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify(e)})).ok)throw new Error("Gagal mendaftarkan subscription ke server")}let f;async function M(e){L(),f=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1}),e.srcObject=f,await e.play()}function $(e){const t=document.createElement("canvas");return t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0),new Promise(a=>t.toBlob(a,"image/jpeg",.85))}function L(){f&&(f.getTracks().forEach(e=>e.stop()),f=null)}(!location.hash||location.hash==="#")&&location.replace("#/");let d;const m=document.getElementById("installBtn"),v=document.getElementById("enablePushBtn"),S=document.getElementById("loginLink"),h=document.getElementById("logoutBtn");function P(){const e=!!_.getToken();S&&(S.hidden=e),h&&(h.hidden=!e)}P();h==null||h.addEventListener("click",()=>{_.clearToken(),localStorage.removeItem("userName"),P(),location.hash="#/"});window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),d=e,m.hidden=!1});m==null||m.addEventListener("click",async()=>{m.hidden=!0,d==null||d.prompt(),await(d==null?void 0:d.userChoice),d=null});v==null||v.addEventListener("click",async()=>{try{await R(),alert("Notifikasi diaktifkan!")}catch(e){console.error(e),alert("Gagal mengaktifkan notifikasi")}});window.addEventListener("load",async()=>{await b();const e="serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window,t=document.getElementById("enablePushBtn");t&&(t.hidden=!e)});window.addEventListener("hashchange",()=>{location.hash!=="#main"&&(L(),A())});window.addEventListener("load",async()=>{var e,t;y==null||y(),await b();try{await navigator.serviceWorker.ready;const r="PushManager"in window&&"Notification"in window,a=/iPhone|iPad|iPod/i.test(navigator.userAgent),n=((t=(e=window.matchMedia)==null?void 0:e.call(window,"(display-mode: standalone)"))==null?void 0:t.matches)||window.navigator.standalone===!0;r&&(!a||n)&&(v.hidden=!1)}catch{}P(),await A()});async function A(){const e=await U(),t=document.getElementById("main");t.innerHTML="",await new e().render(t),E==null||E()}export{_ as S,u as _,L as a,$ as c,M as s};
